<!DOCTYPE html>
<html lang="fr" class="no-js">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="description" content="Guide de montage d'un système d'optimisation de charge en continu pour véhicules Tesla">
<meta name="og:title" content="Tesla optimizer">
<meta name="og:description" content="Guide de montage d'un système d'optimisation de charge en continu pour véhicules Tesla">
<meta name="og:image" content="https://tesla-optimizer.github.io/assets/logo.svg">
<meta name="generator" content="Paradox, paradox-material-theme=0.6.0, mkdocs-material=3.0.3">

<meta name="lang:clipboard.copy" content="Copy to clipboard">
<meta name="lang:clipboard.copied" content="Copied to clipboard">
<meta name="lang:search.language" content="">
<meta name="lang:search.pipeline.stopwords" content="true">
<meta name="lang:search.pipeline.trimmer" content="true">
<meta name="lang:search.result.none" content="No matching documents">
<meta name="lang:search.result.one" content="1 matching document">
<meta name="lang:search.result.other" content="# matching documents">
<meta name="lang:search.tokenizer" content="[\s\-]+">


<meta name="description" content="Guide de montage d'un système d'optimisation de charge en continu pour véhicules Tesla">
<link rel="shortcut icon" href="assets/favicon.png">
<title>Introduction · </title>
<link rel="stylesheet" href="assets/stylesheets/application.451f80e5.css">
<link rel="stylesheet" href="assets/stylesheets/application-palette.22915126.css">
<meta name="theme-color" content="#7cb342" />
<link rel="stylesheet" href="lib/material__tabs/dist/mdc.tabs.min.css">
<link rel="stylesheet" href="lib/prettify/prettify.css">
<script src="assets/javascripts/modernizr.1aa3b519.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Overpass:300,400,400i,700|Overpass+Mono">
<style>
body,input{font-family:"Overpass","Helvetica Neue",Helvetica,Arial,sans-serif}
code,kbd,pre{font-family:"Overpass Mono","Courier New",Courier,monospace}
</style>
<link rel="stylesheet" href="assets/fonts/font-awesome.css">
<link rel="stylesheet" href="assets/fonts/material-icons.css">
<link rel="stylesheet" href="assets/stylesheets/paradox-material-theme.css">
</head>
<body
data-md-color-primary="light-green"
data-md-color-accent="light-green"
>
<input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
<input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
<label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
<header class="md-header" data-md-component="header">
<nav class="md-header-nav md-grid">
<div class="md-flex">
<div class="md-flex__cell md-flex__cell--shrink">
<a href="index.html" title="" class="md-header-nav__button md-logo">
<img src="assets/logo-symbol-only.svg" width="24" height="24">
</a>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
</div>
<div class="md-flex__cell md-flex__cell--stretch">
<div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
<span class="md-header-nav__topic">
</span>
<span class="md-header-nav__topic">
Introduction
</span>
</div>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
<label class="md-icon md-search__icon" for="__search"></label>
<button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">&#xE5CD;</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix>
<div class="md-search-result" data-md-component="result">
<div class="md-search-result__meta">
Type to start searching
</div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>

</div>
<div class="md-flex__cell md-flex__cell--shrink">
<div class="md-header-nav__source">
<a href="https://github.com/tesla-optimizer/tesla-optimizer-tutorial"
title="Go to repository"
class="md-source"
data-md-source="github">
<div class="md-source__icon">
<i class="fa fa-github"></i>
</div>
<div class="md-source__repository">
tesla-optimizer/tesla-optimizer-tutorial
</div>
</a>

</div>
</div>
</div>
</nav>
</header>

<div class="md-container">
<main class="md-main">
<div class="md-main__inner md-grid" data-md-component="container">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--primary" data-md-level="0" style="visibility: hidden">
<label class="md-nav__title md-nav__title--site" for="drawer">
<a href="index.html" title="" class="md-nav__button md-logo">
<span class="md-nav__button md-logo">
<img src="assets/logo-symbol-only.svg" width="24" height="24">
</a>
<a href="index.html" title="">
</a>
</label>
<div class="md-nav__source">
<a href="https://github.com/tesla-optimizer/tesla-optimizer-tutorial"
title="Go to repository"
class="md-source"
data-md-source="github">
<div class="md-source__icon">
<i class="fa fa-github"></i>
</div>
<div class="md-source__repository">
tesla-optimizer/tesla-optimizer-tutorial
</div>
</a>

</div>
<ul>
  <li><a href="introduction.html" class="active page">Introduction</a></li>
  <li><a href="materiel.html" class="page">Matériel</a></li>
  <li><a href="ha.html" class="page">Installation de Home-Assistant</a></li>
  <li><a href="tesla-ha.html" class="page">Tesla custom integration</a></li>
  <li><a href="compteurs.html" class="page">Compteurs électriques Wifi</a></li>
  <li><a href="automation.html" class="page">Automatisation</a></li>
  <li><a href="dashboard.html" class="page">Tableau de bord</a></li>
  <li><a href="about.html" class="page">A propos de ce guide</a></li>
</ul>
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul>
  <li><a href="introduction.html#introduction" class="header">Introduction</a>
  <ul>
    <li><a href="introduction.html#principe" class="header">Principe</a></li>
    <li><a href="introduction.html#elements-de-base" class="header">Elements de base</a></li>
    <li><a href="introduction.html#tableaux-de-bord" class="header">Tableaux de bord</a></li>
  </ul></li>
</ul>
</nav>

</nav>
<ul style="display: none">
<li class="md-nav__item md-version" id="project.version">
<label class="md-nav__link" for="__version">
<i class="md-icon" title="Version">label_outline</i> 0.1.0*
</label>
</li>
</ul>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul>
  <li><a href="introduction.html#introduction" class="header">Introduction</a>
  <ul>
    <li><a href="introduction.html#principe" class="header">Principe</a></li>
    <li><a href="introduction.html#elements-de-base" class="header">Elements de base</a></li>
    <li><a href="introduction.html#tableaux-de-bord" class="header">Tableaux de bord</a></li>
  </ul></li>
</ul>
</nav>

</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<div class="md-content__searchable">
<h1><a href="#introduction" name="introduction" class="anchor"><span class="anchor-link"></span></a>Introduction</h1>
<p>Pour les heureux détenteurs de panneaux photovoltaïques et d&rsquo;une tarification électrique variable, il est possible de se fabriquer soi-même un système d&rsquo;optimisation de la charge pour minimiser les coûts en électricité et maximiser l&rsquo;utilisation de la production solaire.</p>
<h2><a href="#principe" name="principe" class="anchor"><span class="anchor-link"></span></a>Principe</h2>
<p>Le système mesure en continu l&rsquo;injection de courant solaire et la consommation domestique. Il est configuré avec les horaires de tarification différenciée (double tarif). Il est capable de localiser, démarrer et arrêter la charge de la Tesla, ainsi que de moduler l&rsquo;ampérage (la quantité de courant envoyé dans la prise). Grâce à ces éléments et à des algorithmes simples tels qu&rsquo;une moyenne glissante le système ajuste la charge à intervalles réguliers pour minimiser les frais et maximimiser l&rsquo;auto-consommation. </p>
<h2><a href="#elements-de-base" name="elements-de-base" class="anchor"><span class="anchor-link"></span></a>Elements de base</h2>
<p>Le système repose sur trois piliers:</p>
<ol>
  <li>Un boîtier central domotique (<a href="https://www.home-assistant.io/">Home Assistant</a>)</li>
  <li>L&rsquo;envoi de commandes à la voiture via l&rsquo;<a href="https://www.teslaapi.io/">API Tesla</a></li>
  <li>Des compteurs d&rsquo;électricité connectés (Wifi) qui mesurent en permanence la consommation et l&rsquo;injection de courant solaire.</li>
</ol>
<h2><a href="#tableaux-de-bord" name="tableaux-de-bord" class="anchor"><span class="anchor-link"></span></a>Tableaux de bord</h2>
<p><em>Home Assistant</em> permet d&rsquo;élaborer des tableaux de bords disponibles sur un browser ou via une application. En voici quelques examples:</p>
<p><img src="assets/flows.gif" alt="flows" /></p>
<blockquote>
  <p>Diagramme des flux de courant: les panneaux solaires produisent environ 3KW, dont 2.2KW peuvent être envoyés dans la Tesla (je charge au 220V) et le reste est absorbé par la consommation domestique. Le réseau n&rsquo;est presque pas solicité. </p>
</blockquote>
<p><img src="assets/dynamic-charge.png" alt="dynamic-charge" /></p>
<blockquote>
  <p>Graphe représentant l&rsquo;évolution de l&rsquo;ampérage de charge. En bleu foncé, la valeur cible instantanée telle que calculée par le système en continu: la valeur varie de façon importante suivant l&rsquo;évolution de la couverture nuageuse et la consommation domestique (pompe à chaleur). En rose, la valeur cible telle que calculée par le système avec une &ldquo;moyenne glissante&rdquo;. En bleu clair, la charge effective telle que mesurée par le compteur électrique sur la prise dans le garage. Sa valeur varie par paliers, du fait que la mise à jour de l&rsquo;ampérage a lieu toutes les 3 minutes (décision arbitraire pour éviter d&rsquo;envoyer trop de commandes à l&rsquo;API). La charge s&rsquo;arrête vers 10:30 quand la batterie arrive au pourcentage de charge desiré. Vous l&rsquo;aurez compris, ma Tesla s&rsquo;appelle <em>Ferrite</em> 😀 </p>
</blockquote><div class="callout note info"><div class="callout-title">Reverse-engineering</div>
<p>Tesla ne publie pas son API (acronyme pour &ldquo;Application Programming Interface&rdquo;), elle a donc été obtenue par <em><a href="https://www.teslaapi.io/#is-this-api-official">reverse-engineering</a></em>, c&rsquo;est-à-dire en analysant le traffic internet de l&rsquo;application Tesla. Malgré le fait que cela ne soit pas officiel, l&rsquo;API n&rsquo;évolue pas brusquement, car Tesla doit maintenir la compatibilité avec une variété de versions de son app. Le service <a href="https://about.teslafi.com/">TeslaFi</a> qui permet de suivre l&rsquo;utilisation de sa Tesla existe depuis 2016 et utilise cette même API. En 2020, Tesla a amélioré son système d&rsquo;authentification pour permettre d&rsquo;utilisation de deux-facteurs et la <a href="https://support.teslafi.com/en/communities/1/topics/16979-tesla-v3-api-tokens">communauté s&rsquo;est aussi adaptée</a>. </p></div>
</div>
<div class="print-only">
<span class="md-source-file md-version">
0.1.0*
</span>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav class="md-footer-nav__inner md-grid">
<a href="index.html" title="" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
</div>
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Previous
</span>
</span>
</div>
</a>
<a href="materiel.html" title="Matériel" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Next
</span>
Matériel
</span>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
<div class="md-footer-copyright__highlight">
Tesla-optimizer contributors
</div>
Powered by
<a href="https://github.com/lightbend/paradox">Paradox</a>
and
<a href="https://jonas.github.io/paradox-material-theme/">Paradox Material Theme</a>

</div>
<div class="md-footer-social">
<a href="https://github.com/tesla-optimizer/tesla-optimizer-tutorial" class="md-footer-social__link fa fa-github"></a>
</div>

</div>
</div>
</footer>

</div>
<script src="assets/javascripts/application.583bbe55.js"></script>
<script src="assets/javascripts/paradox-material-theme.js"></script>
<script>app.initialize({version:"0.17",url:{base:"."}})</script>
<script type="text/javascript" src="lib/prettify/prettify.js"></script>
<script type="text/javascript" src="lib/prettify/lang-scala.js"></script>
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function(event) {
window.prettyPrint && prettyPrint();
});
</script>
<script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create",""),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})});if(document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>

</body>
</html>